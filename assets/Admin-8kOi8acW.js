import{f as v,g as C,c as s,b as t,l as j,F as z,h as D,M as _,N as y,B as l,o as i,t as c,Q as p,A as f}from"./index-DdogNGVd.js";const A={class:"container my-5 pt-5"},N=t("h1",{class:"mb-4"},"Panel Admina – wszystkie wizyty",-1),B={key:0,class:"text-center my-4"},M=t("div",{class:"spinner-border",role:"status"},[t("span",{class:"visually-hidden"},"Ładowanie...")],-1),E=[M],Z={key:1},F={key:0,class:"alert alert-info"},L={key:1,class:"table-responsive"},O={class:"table table-striped"},P=t("thead",null,[t("tr",null,[t("th",null,"ID wizyty"),t("th",null,"Typ wizyty"),t("th",null,"Data"),t("th",null,"Godzina"),t("th",null,"Użytkownik"),t("th",null,"Przychodnia"),t("th",null,"Zdjęcia"),t("th",null,"Opis"),t("th",null,"Akcje")])],-1),V={key:0},$={key:1},G={key:0},H={key:0},Q=["src","onClick"],T={key:1},U={key:1},q=["onClick"],J={key:2},K=t("div",{class:"modal-backdrop fade show"},null,-1),R={class:"modal fade show d-block",tabindex:"-1",role:"dialog"},W={class:"modal-dialog modal-dialog-centered modal-lg",role:"document"},X={class:"modal-content"},Y={class:"modal-body text-center"},tt=["src"],ot={__name:"Admin",setup(et){const d=v([]),k=v(!0),u=v(null);function w(o){return o&&typeof o.toDate=="function"?o.toDate():new Date(o)}async function g(){k.value=!0,d.value=[];const o=await _(y(l,"remoteappointments"));for(const e of o.docs){const n=e.data(),r=await _(y(l,"remoteappointments",e.id,"uploads")),h=[];r.docs.forEach(m=>{const a=m.data();a.type==="image"&&a.url&&h.push(a.url)}),d.value.push({key:e.id,type:"remote",date:w(n.date),hour:n.contactHour||n.hour||"",userId:n.userId||"",images:h,description:n.description||""})}const b=await _(y(l,"clinics"));for(const e of b.docs){const n=e.id,r=e.data().name||n;(await _(y(l,"clinics",n,"appointments"))).forEach(m=>{const a=m.data();d.value.push({key:m.id,type:"clinic",clinicId:n,clinicName:r,date:w(a.date),hour:a.hour||"",userId:a.userId||"",images:[],description:a.description||""})})}d.value.sort((e,n)=>e.date<n.date?-1:e.date>n.date?1:e.hour.localeCompare(n.hour)),k.value=!1}function I(o){u.value=o}function S(){u.value=null}async function x(o){confirm("Na pewno chcesz anulować tę wizytę?")&&(o.type==="remote"?await p(f(l,"remoteappointments",o.key)):await p(f(l,"clinics",o.clinicId,"appointments",o.key)),await p(f(l,"users",o.userId,"appointments",o.key)),await g())}return C(g),(o,b)=>(i(),s("div",A,[N,k.value?(i(),s("div",B,E)):(i(),s("div",Z,[d.value.length?(i(),s("div",L,[t("table",O,[P,t("tbody",null,[(i(!0),s(z,null,D(d.value,e=>(i(),s("tr",{key:e.key},[t("td",null,c(e.key),1),t("td",null,c(e.type==="remote"?"Online":"Stacjonarna"),1),t("td",null,c(e.date.toLocaleDateString()),1),t("td",null,c(e.hour||"–"),1),t("td",null,c(e.userId),1),e.type==="clinic"?(i(),s("td",V,c(e.clinicName),1)):(i(),s("td",$,"–")),t("td",null,[e.type==="remote"?(i(),s("div",G,[e.images.length?(i(),s("div",H,[(i(!0),s(z,null,D(e.images,(n,r)=>(i(),s("img",{key:r,src:n,alt:"Zdjęcie wizyty",class:"img-thumbnail me-1 clickable-image",style:{width:"50px",height:"50px",cursor:"pointer"},onClick:h=>I(n)},null,8,Q))),128))])):(i(),s("div",T,"–"))])):(i(),s("div",U,"–"))]),t("td",null,c(e.description||"–"),1),t("td",null,[t("button",{class:"btn btn-sm btn-danger",onClick:n=>x(e)}," Anuluj ",8,q)])]))),128))])])])):(i(),s("div",F," Brak wizyt do wyświetlenia. "))])),u.value?(i(),s("div",J,[K,t("div",R,[t("div",W,[t("div",X,[t("div",{class:"modal-header"},[t("button",{type:"button",class:"btn-close",onClick:S})]),t("div",Y,[t("img",{src:u.value,class:"img-fluid",alt:"Zdjęcie wizyty"},null,8,tt)])])])])])):j("",!0)]))}};export{ot as default};
